module.exports=function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){if("object"===("undefined"==typeof console?"undefined":o(console))){var e=Array.prototype.slice.call(arguments,1),r=t?console.error:console.info;(r=Function.prototype.bind.call(r,console)).apply(console,["[Affiliate] "].concat(e))}}},function(t,e){t.exports=require("docile")},function(t,e){t.exports=require("url-parse")},function(t,e,r){"use strict";var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},n=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}();var i=r(2),a=r(1),s=r(0),c=!(void 0===window.MutationObserver),f=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=o({tags:[]},e);var n=[];for(var i in e.tags)e.tags[i]=o({hosts:[],query:{},replace:[]},e.tags[i]),n=n.concat(e.tags[i].hosts);this.log=e.log?s:function(){},this.log(!1,"New Instance",e),c&&(this.observer=new window.MutationObserver(function(t){for(var e in r.log(!1,"DOM Mutation"),t){if("attributes"===t[e].type){if("href"!==t[e].attributeName)continue;var o=t[e].target.getAttribute("href"),n=a.get(t[e].target)||{};if(n.is&&n.is===o)continue}r.traverseNodes(t[e].target)}})),this.state={attached:!1,config:e,hosts:n}}return n(t,[{key:"traverseNodes",value:function(t){t||(t=document.body),this.log(!1,"Traversing DOM...");var e=t.getElementsByTagName("a"),r=[];for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);for(var n in"a"===t.nodeName.toLowerCase()&&(r=[t]),r){if(!r[n]||!r[n].getAttribute("href"))return;var a=i(r[n].getAttribute("href")||"",!0);if(-1!==this.state.hosts.indexOf(a.host))for(var s in this.state.config.tags)this.state.config.tags[s].hosts.indexOf(a.host)>=0&&this.modifyURL(a,r[n],this.state.config.tags[s])}}},{key:"modifyURL",value:function(t,e,r){var n=a.get(e)||{};if(!n.is||n.is!==t.href){var c=t.href;if(this.log(!1,"Discovered URL: "+t.href),t.set("query",o({},t.query,r.query)),"function"==typeof r.modify)try{var f=r.modify(t);t=i(f.href||f,!0)}catch(t){s(!0,t)}for(var u in t=t.href,r.replace)t=t.replace(r.replace[u].from,r.replace[u].to);e.setAttribute("href",t),a.set(e,{was:c,is:t})}}},{key:"attach",value:function(){if(!this.state.attached){var t=document.readyState;if("complete"!==t&&"interactive"!==t)return window.addEventListener("DOMContentLoaded",this.attach.bind(this));this.state.attached=!0,this.traverseNodes(),c?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeFilter:["href"]}):this.log(!1,"Browser does not support MutationObserver.")}}},{key:"detach",value:function(){c&&(this.state.attached=!1,this.observer.disconnect(),this.log(!1,"Observer disconnected."))}}]),t}();t.exports=f},function(t,e,r){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function t(e,r){if("object"===(void 0===e?"undefined":o(e)))for(var n in e)e[n]=t(e[n],r);else if("string"==typeof e)for(var i in e=e.split(r))e[i]=e[i].trim();return e};t.exports=function(){var t=document.getElementById("aff-js");if("object"===(void 0===t?"undefined":o(t))&&null!==t){var e=t.getAttribute("data-aff");if("string"==typeof e){var r=n(n(n(n(e,"!"),":"),","),"="),i=[];for(var a in r){var s={hosts:[],query:{}};for(var c in r[a][0])s.hosts.push(r[a][0][c][0]);for(var f in r[a][1])s.query[r[a][1][f][0]]=r[a][1][f][1];i.push(s)}return{tags:i}}}}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";(function(e){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=r(1),i=r(4),a=r(3),s=r(0);e.instanceList=e.instanceList||[];var c=function(t){var r=new a(t);return e.instanceList.push(r),r};c.instances=function(){return[].concat(e.instanceList)},c.detachAll=function(){for(var t in e.instanceList)e.instanceList[t].detach()},c.revert=function(){c.detachAll();var t=[].slice.call(document.body.getElementsByTagName("a"));for(var e in t){var r=n.get(t[e]);r&&r.was&&(t[e].setAttribute("href",r.was),n.set(t[e],{}))}};try{var f=i();if("object"===(void 0===f?"undefined":o(f))){var u=c(f);s(!1,u),c.automatic=u,u.attach()}}catch(t){s(!0,t)}t.exports=c}).call(this,r(5))}]);